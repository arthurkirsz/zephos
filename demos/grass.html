<style type="text/css">
  * {
    margin: 0;
    padding: 0;
    font-family: sans-serif;
    font-weight: 100;
  }

  body {
    background: #1f2127;
  }

  h1 {
    margin: 20px;
    text-align: center;
    color: #fff;
  }

  canvas {
    display: block;
    position:fixed;
    top:0px;
    left:0px;
  }
</style>
<canvas id="canvas" onclick="spawn()"></canvas>
<script type="text/javascript" src="./zephos.js"></script>
<script type="text/javascript">
  window.requestAnimFrame =
    window.requestAnimationFrame ||
    window.webkitRequestAnimationFrame ||
    window.mozRequestAnimationFrame ||
    window.oRequestAnimationFrame ||
    window.msRequestAnimationFrame ||
    function(callback) {
      return window.setTimeout(callback, 1000 / 60);
    };

  var canvas = document.getElementById('canvas');
  var ctx = canvas.getContext('2d');
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;


  var Loop = function() {    
    ctx.fillStyle = '#1f2127';
    //ctx.fillRect(0, 0, canvas.width, canvas.height);



    ctx.shadowColor = '#88FF88';
    ctx.shadowBlur = 10;
    ctx.shadowOffsetX = 0;
    ctx.shadowOffsetY = 0;



    Zephos.update();
    window.requestAnimFrame(Loop);
  };
  Loop();

  function spawn() {
    for(j in Zephos.generateParticles(600, Std.randInt(canvas.width), canvas.height, ctx) ) {
      var p = Zephos.particles[j];

      p.x = Std.randInt(canvas.width);
      p.y = canvas.height - Std.randInt(20);


      p.gy = -0.03 - Std.randFloat(0.02);
      p.frictY = 1.0002;
      p.life = Std.randInt(90);
      p.dy = Math.abs(p.dy);
      p.circle = !!(Math.random() < 0.4 )
    }
  }
</script>